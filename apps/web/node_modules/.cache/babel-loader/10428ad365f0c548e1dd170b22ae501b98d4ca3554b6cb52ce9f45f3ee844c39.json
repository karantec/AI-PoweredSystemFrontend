{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nexport function useChat(userId) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [conversationId, setConversationId] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isTyping, setIsTyping] = useState(false);\n  const [currentAgent, setCurrentAgent] = useState('');\n  const [reasoning, setReasoning] = useState('');\n  const sendMessage = async content => {\n    const userMessage = {\n      id: Date.now().toString(),\n      role: 'user',\n      content,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setIsLoading(true);\n    setIsTyping(true);\n    setReasoning('Processing...');\n    try {\n      var _response$body;\n      const response = await fetch('http://localhost:5000/api/chat/messages', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          conversationId: conversationId,\n          message: content,\n          userId\n        })\n      });\n      const reader = (_response$body = response.body) === null || _response$body === void 0 ? void 0 : _response$body.getReader();\n      const decoder = new TextDecoder();\n      let assistantContent = '';\n      let tempAgent = '';\n      if (reader) {\n        while (true) {\n          const {\n            done,\n            value\n          } = await reader.read();\n          if (done) break;\n          const chunk = decoder.decode(value);\n          const lines = chunk.split('\\n').filter(Boolean);\n          for (const line of lines) {\n            try {\n              const data = JSON.parse(line);\n              if (data.type === 'conversation_id') {\n                setConversationId(data.data);\n              } else if (data.type === 'agent') {\n                tempAgent = data.data;\n                setCurrentAgent(data.data);\n              } else if (data.type === 'reasoning') {\n                setReasoning(data.data);\n              } else if (data.type === 'text') {\n                assistantContent += data.data;\n                setMessages(prev => {\n                  const lastMsg = prev[prev.length - 1];\n                  if (lastMsg && lastMsg.role === 'assistant' && !lastMsg.id.startsWith('final-')) {\n                    return [...prev.slice(0, -1), {\n                      ...lastMsg,\n                      content: assistantContent\n                    }];\n                  }\n                  return [...prev, {\n                    id: 'temp-' + Date.now(),\n                    role: 'assistant',\n                    content: assistantContent,\n                    agent: tempAgent,\n                    timestamp: new Date()\n                  }];\n                });\n              } else if (data.type === 'done') {\n                setIsTyping(false);\n                setMessages(prev => {\n                  const lastMsg = prev[prev.length - 1];\n                  if (lastMsg && lastMsg.role === 'assistant') {\n                    return [...prev.slice(0, -1), {\n                      ...lastMsg,\n                      id: 'final-' + Date.now()\n                    }];\n                  }\n                  return prev;\n                });\n              }\n            } catch (e) {\n              console.error('Parse error:', e);\n            }\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n      setMessages(prev => [...prev, {\n        id: Date.now().toString(),\n        role: 'assistant',\n        content: 'Sorry, there was an error processing your request.',\n        timestamp: new Date()\n      }]);\n    } finally {\n      setIsLoading(false);\n      setIsTyping(false);\n      setReasoning('');\n    }\n  };\n  return {\n    messages,\n    isLoading,\n    isTyping,\n    currentAgent,\n    reasoning,\n    sendMessage\n  };\n}\n_s(useChat, \"3MxMFZ17/nCFsXTFAoAwZcZ0Zns=\");","map":{"version":3,"names":["useState","useChat","userId","_s","messages","setMessages","conversationId","setConversationId","isLoading","setIsLoading","isTyping","setIsTyping","currentAgent","setCurrentAgent","reasoning","setReasoning","sendMessage","content","userMessage","id","Date","now","toString","role","timestamp","prev","_response$body","response","fetch","method","headers","body","JSON","stringify","message","reader","getReader","decoder","TextDecoder","assistantContent","tempAgent","done","value","read","chunk","decode","lines","split","filter","Boolean","line","data","parse","type","lastMsg","length","startsWith","slice","agent","e","console","error"],"sources":["C:/Users/karan/OneDrive/Desktop/customer-support-ai/apps/web/src/hooks/useChat.ts"],"sourcesContent":["import { useState } from 'react';\r\n\r\ninterface Message {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  agent?: string;\r\n  timestamp: Date;\r\n}\r\n\r\nexport function useChat(userId: string) {\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [conversationId, setConversationId] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [currentAgent, setCurrentAgent] = useState<string>('');\r\n  const [reasoning, setReasoning] = useState<string>('');\r\n\r\n  const sendMessage = async (content: string) => {\r\n    const userMessage: Message = {\r\n      id: Date.now().toString(),\r\n      role: 'user',\r\n      content,\r\n      timestamp: new Date(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setIsLoading(true);\r\n    setIsTyping(true);\r\n    setReasoning('Processing...');\r\n\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/chat/messages', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          conversationId: conversationId,\r\n          message: content,\r\n          userId,\r\n        }),\r\n      });\r\n\r\n      const reader = response.body?.getReader();\r\n      const decoder = new TextDecoder();\r\n      let assistantContent = '';\r\n      let tempAgent = '';\r\n\r\n      if (reader) {\r\n        while (true) {\r\n          const { done, value } = await reader.read();\r\n          if (done) break;\r\n\r\n          const chunk = decoder.decode(value);\r\n          const lines = chunk.split('\\n').filter(Boolean);\r\n\r\n          for (const line of lines) {\r\n            try {\r\n              const data = JSON.parse(line);\r\n\r\n              if (data.type === 'conversation_id') {\r\n                setConversationId(data.data);\r\n              } else if (data.type === 'agent') {\r\n                tempAgent = data.data;\r\n                setCurrentAgent(data.data);\r\n              } else if (data.type === 'reasoning') {\r\n                setReasoning(data.data);\r\n              } else if (data.type === 'text') {\r\n                assistantContent += data.data;\r\n                setMessages((prev) => {\r\n                  const lastMsg = prev[prev.length - 1];\r\n                  if (lastMsg && lastMsg.role === 'assistant' && !lastMsg.id.startsWith('final-')) {\r\n                    return [\r\n                      ...prev.slice(0, -1),\r\n                      { ...lastMsg, content: assistantContent },\r\n                    ];\r\n                  }\r\n                  return [\r\n                    ...prev,\r\n                    {\r\n                      id: 'temp-' + Date.now(),\r\n                      role: 'assistant',\r\n                      content: assistantContent,\r\n                      agent: tempAgent,\r\n                      timestamp: new Date(),\r\n                    },\r\n                  ];\r\n                });\r\n              } else if (data.type === 'done') {\r\n                setIsTyping(false);\r\n                setMessages((prev) => {\r\n                  const lastMsg = prev[prev.length - 1];\r\n                  if (lastMsg && lastMsg.role === 'assistant') {\r\n                    return [\r\n                      ...prev.slice(0, -1),\r\n                      { ...lastMsg, id: 'final-' + Date.now() },\r\n                    ];\r\n                  }\r\n                  return prev;\r\n                });\r\n              }\r\n            } catch (e) {\r\n              console.error('Parse error:', e);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        {\r\n          id: Date.now().toString(),\r\n          role: 'assistant',\r\n          content: 'Sorry, there was an error processing your request.',\r\n          timestamp: new Date(),\r\n        },\r\n      ]);\r\n    } finally {\r\n      setIsLoading(false);\r\n      setIsTyping(false);\r\n      setReasoning('');\r\n    }\r\n  };\r\n\r\n  return {\r\n    messages,\r\n    isLoading,\r\n    isTyping,\r\n    currentAgent,\r\n    reasoning,\r\n    sendMessage,\r\n  };\r\n}"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAUhC,OAAO,SAASC,OAAOA,CAACC,MAAc,EAAE;EAAAC,EAAA;EACtC,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGL,QAAQ,CAAY,EAAE,CAAC;EACvD,MAAM,CAACM,cAAc,EAAEC,iBAAiB,CAAC,GAAGP,QAAQ,CAAgB,IAAI,CAAC;EACzE,MAAM,CAACQ,SAAS,EAAEC,YAAY,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACU,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAACY,YAAY,EAAEC,eAAe,CAAC,GAAGb,QAAQ,CAAS,EAAE,CAAC;EAC5D,MAAM,CAACc,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAS,EAAE,CAAC;EAEtD,MAAMgB,WAAW,GAAG,MAAOC,OAAe,IAAK;IAC7C,MAAMC,WAAoB,GAAG;MAC3BC,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;MACzBC,IAAI,EAAE,MAAM;MACZN,OAAO;MACPO,SAAS,EAAE,IAAIJ,IAAI,CAAC;IACtB,CAAC;IAEDf,WAAW,CAAEoB,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAEP,WAAW,CAAC,CAAC;IAC7CT,YAAY,CAAC,IAAI,CAAC;IAClBE,WAAW,CAAC,IAAI,CAAC;IACjBI,YAAY,CAAC,eAAe,CAAC;IAE7B,IAAI;MAAA,IAAAW,cAAA;MACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,yCAAyC,EAAE;QACtEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnB3B,cAAc,EAAEA,cAAc;UAC9B4B,OAAO,EAAEjB,OAAO;UAChBf;QACF,CAAC;MACH,CAAC,CAAC;MAEF,MAAMiC,MAAM,IAAAT,cAAA,GAAGC,QAAQ,CAACI,IAAI,cAAAL,cAAA,uBAAbA,cAAA,CAAeU,SAAS,CAAC,CAAC;MACzC,MAAMC,OAAO,GAAG,IAAIC,WAAW,CAAC,CAAC;MACjC,IAAIC,gBAAgB,GAAG,EAAE;MACzB,IAAIC,SAAS,GAAG,EAAE;MAElB,IAAIL,MAAM,EAAE;QACV,OAAO,IAAI,EAAE;UACX,MAAM;YAAEM,IAAI;YAAEC;UAAM,CAAC,GAAG,MAAMP,MAAM,CAACQ,IAAI,CAAC,CAAC;UAC3C,IAAIF,IAAI,EAAE;UAEV,MAAMG,KAAK,GAAGP,OAAO,CAACQ,MAAM,CAACH,KAAK,CAAC;UACnC,MAAMI,KAAK,GAAGF,KAAK,CAACG,KAAK,CAAC,IAAI,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC;UAE/C,KAAK,MAAMC,IAAI,IAAIJ,KAAK,EAAE;YACxB,IAAI;cACF,MAAMK,IAAI,GAAGnB,IAAI,CAACoB,KAAK,CAACF,IAAI,CAAC;cAE7B,IAAIC,IAAI,CAACE,IAAI,KAAK,iBAAiB,EAAE;gBACnC9C,iBAAiB,CAAC4C,IAAI,CAACA,IAAI,CAAC;cAC9B,CAAC,MAAM,IAAIA,IAAI,CAACE,IAAI,KAAK,OAAO,EAAE;gBAChCb,SAAS,GAAGW,IAAI,CAACA,IAAI;gBACrBtC,eAAe,CAACsC,IAAI,CAACA,IAAI,CAAC;cAC5B,CAAC,MAAM,IAAIA,IAAI,CAACE,IAAI,KAAK,WAAW,EAAE;gBACpCtC,YAAY,CAACoC,IAAI,CAACA,IAAI,CAAC;cACzB,CAAC,MAAM,IAAIA,IAAI,CAACE,IAAI,KAAK,MAAM,EAAE;gBAC/Bd,gBAAgB,IAAIY,IAAI,CAACA,IAAI;gBAC7B9C,WAAW,CAAEoB,IAAI,IAAK;kBACpB,MAAM6B,OAAO,GAAG7B,IAAI,CAACA,IAAI,CAAC8B,MAAM,GAAG,CAAC,CAAC;kBACrC,IAAID,OAAO,IAAIA,OAAO,CAAC/B,IAAI,KAAK,WAAW,IAAI,CAAC+B,OAAO,CAACnC,EAAE,CAACqC,UAAU,CAAC,QAAQ,CAAC,EAAE;oBAC/E,OAAO,CACL,GAAG/B,IAAI,CAACgC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EACpB;sBAAE,GAAGH,OAAO;sBAAErC,OAAO,EAAEsB;oBAAiB,CAAC,CAC1C;kBACH;kBACA,OAAO,CACL,GAAGd,IAAI,EACP;oBACEN,EAAE,EAAE,OAAO,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;oBACxBE,IAAI,EAAE,WAAW;oBACjBN,OAAO,EAAEsB,gBAAgB;oBACzBmB,KAAK,EAAElB,SAAS;oBAChBhB,SAAS,EAAE,IAAIJ,IAAI,CAAC;kBACtB,CAAC,CACF;gBACH,CAAC,CAAC;cACJ,CAAC,MAAM,IAAI+B,IAAI,CAACE,IAAI,KAAK,MAAM,EAAE;gBAC/B1C,WAAW,CAAC,KAAK,CAAC;gBAClBN,WAAW,CAAEoB,IAAI,IAAK;kBACpB,MAAM6B,OAAO,GAAG7B,IAAI,CAACA,IAAI,CAAC8B,MAAM,GAAG,CAAC,CAAC;kBACrC,IAAID,OAAO,IAAIA,OAAO,CAAC/B,IAAI,KAAK,WAAW,EAAE;oBAC3C,OAAO,CACL,GAAGE,IAAI,CAACgC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EACpB;sBAAE,GAAGH,OAAO;sBAAEnC,EAAE,EAAE,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC;oBAAE,CAAC,CAC1C;kBACH;kBACA,OAAOI,IAAI;gBACb,CAAC,CAAC;cACJ;YACF,CAAC,CAAC,OAAOkC,CAAC,EAAE;cACVC,OAAO,CAACC,KAAK,CAAC,cAAc,EAAEF,CAAC,CAAC;YAClC;UACF;QACF;MACF;IACF,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9CxD,WAAW,CAAEoB,IAAI,IAAK,CACpB,GAAGA,IAAI,EACP;QACEN,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;QACzBC,IAAI,EAAE,WAAW;QACjBN,OAAO,EAAE,oDAAoD;QAC7DO,SAAS,EAAE,IAAIJ,IAAI,CAAC;MACtB,CAAC,CACF,CAAC;IACJ,CAAC,SAAS;MACRX,YAAY,CAAC,KAAK,CAAC;MACnBE,WAAW,CAAC,KAAK,CAAC;MAClBI,YAAY,CAAC,EAAE,CAAC;IAClB;EACF,CAAC;EAED,OAAO;IACLX,QAAQ;IACRI,SAAS;IACTE,QAAQ;IACRE,YAAY;IACZE,SAAS;IACTE;EACF,CAAC;AACH;AAACb,EAAA,CA1HeF,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}